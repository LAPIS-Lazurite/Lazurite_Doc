<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>SubGHz.decMac</title>
<style type="text/css">
#contents{
	width:850px;
	margin-left:auto;
	margin-right:auto;
}
.auto-style1 {
	margin-left: 40px;
}
.auto-style5 {
	text-align: center;
}
.auto-style7 {
	margin-left: 40px;
	text-align: left;
	font-family: メイリオ;
	color: #666666;
}
.auto-style10 {
	color: #666666;
	font-weight: normal;
	font-family: メイリオ;
}
.auto-style11 {
	font-family: メイリオ;
	color: #666666;
}
.auto-style12{
	font-family: メイリオ;
	color: #666666;
	margin-bottom:40px;
	margin-left:40px;
}
td{
	padding:0px 5px;
}

.auto-style13 {
	font-family: メイリオ;
	color: #666666;
	margin-left: 40px;
}
.auto-style14 {
	margin-left: 80px;
	text-align: left;
	font-family: メイリオ;
	color: #666666;
}
.auto-style16 {
	font-family: メイリオ;
	color: #666666;
	text-align: center;
}

.auto-style18 {
	margin-left: 40px;
	font-family: メイリオ;
}

.auto-style19 {
	border-collapse: collapse;
	border-right-width: 0px;
	border-top-width: 0px;
	border-bottom-width: 0px;
}
.auto-style20 {
	border-style: solid;
	border-width: 1px;
	text-align: center;
}
.auto-style21 {
	border-style: solid;
	border-width: 1px;
}

</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8147436-1', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body>
<h1 class="auto-style5">
<img height="35" src="../Lazurite_logo.png" width="179" class="auto-style1" />　<span class="auto-style10">Lazurite 
日本語リファレンス</span></h1>
<hr />
<div id="contents">
<h2 class="auto-style10">void SubGHz.decMac(*mac,*raw,raw_len) </h2>
<br/>
<h3 class="auto-style11">詳細</h3>
<p class="auto-style7">void SubGHz.decMac(SUBGHZ_MAC_PARAM *mac,uint8_t 
*raw,uint16_t raw_len);</p>
<h3 class="auto-style11">仕様</h3>
<p class="auto-style12">受信したrawデータを各種パラメータに分解するための機能です</p>
<h3 class="auto-style11">パラメータ</h3>
<h4 class="auto-style11">&nbsp;&nbsp;&nbsp; SUBGHZ_MAC_PARAM *mac</h4>
<p class="auto-style7">
受信したデータを展開するSUBGHZ_MAC_PARAM構造体のポインタを指定します。<br />
SUBGHZ_MAC_PARAM構造体は次のメンバ変数で構成されています。</p>
	<p class="auto-style7">
	<table border="0" cellpadding="0" cellspacing="0" class="auto-style19" style="width: 554pt" width="739">
		<colgroup>
			<col style="mso-width-source: userset; mso-width-alt: 10752;" />
			<col style="mso-width-source:userset;mso-width-alt:12896;width:302pt" width="403" />
		</colgroup>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style20" height="18" style="width: 518px">変数名</td>
			<td class="auto-style20" style="width: 595px">説明</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">
			u_MAC_HEADER mac_header;</td>
			<td class="auto-style21" style="width: 595px">macヘッダを示すunion共用体です</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp; 
			uint8_t data[2];</td>
			<td class="auto-style21" style="width: 595px">
			mac_headerのメンバ変数で、2バイトのmacヘッダ保持用メモリです。</td>
		</tr>
		<tr height="54" style="height:40.5pt">
			<td class="auto-style21" height="54" style="width: 518px">&nbsp;&nbsp;&nbsp; 
			s_MAC_HEADER_BIT_ALIGNMENT alignment;</td>
			<td class="auto-style21" style="width: 595px">
			mac_headerのメンバ変数で、macヘッダを分解するためのビットフィールドです。<br />
			各ビットフィールドの詳細は<a href="../IEEE802154/ieee802154e_format.html">こちら</a>を参照してください。<br />
			Endianの影響を受けるため、移植の際は注意してください。</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t frame_type:3;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でframe_typeを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t sec_enb:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でsec_enbを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t pending:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でpendingを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t ack_req:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でack_reqを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t panid_comp:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でpanid_compを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t nop:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数で空きビットを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t seq_comp:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でseq_compを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t ielist:1;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でielistを示します。</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t tx_addr_type:2;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でtx_addr_typeを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t frame_ver:2;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でframe_verを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
			uint8_t rx_addr_type:2;</td>
			<td class="auto-style21" style="width: 595px">
			s_MAC_HEADER_BIT_ALIGNMENT のメンバ変数でrx_addr_typeを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint8_t 
			addr_type;</td>
			<td class="auto-style21" style="width: 595px">アドレスタイプを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint16_t 
			rx_panid;</td>
			<td class="auto-style21" style="width: 595px">受信PANIDを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint8_t 
			rx_addr[8];</td>
			<td class="auto-style21" style="width: 595px">受信アドレスを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint16_t 
			tx_panid;</td>
			<td class="auto-style21" style="width: 595px">送信PANIDを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint8_t 
			tx_addr[8];</td>
			<td class="auto-style21" style="width: 595px">送信アドレスを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint8_t 
			*raw;</td>
			<td class="auto-style21" style="width: 595px">rawデータのポインタを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">int16_t 
			raw_len;</td>
			<td class="auto-style21" style="width: 595px">rawデータのサイズを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">uint8_t 
			*payload;</td>
			<td class="auto-style21" style="width: 595px">
			payload(受信した実データ)のポインタを示します</td>
		</tr>
		<tr height="18" style="height:13.5pt">
			<td class="auto-style21" height="18" style="width: 518px">int16_t 
			payload_len;</td>
			<td class="auto-style21" style="width: 595px">payloadのサイズを示します。</td>
		</tr>
	</table>
	</p>
<h4 class="auto-style11">&nbsp;&nbsp;&nbsp; uint8_t *raw</h4>
	<p class="auto-style13">
	受信したデータの先頭ポインタを指定します</p>
	<h4 class="auto-style16">&nbsp;</h4>
<h4 class="auto-style11">&nbsp;&nbsp;&nbsp; uint16_t raw_len</h4>
<p class="auto-style14">送信データのサイズを指定します。</p>
	<h3 class="auto-style10"><strong>戻り値</strong></h3>
<p class="auto-style18">なし</p>
	<p class="auto-style18">&nbsp;</p>
<h3 class="auto-style11">サンプル</h3>
	<p class="auto-style13">サンプルプログラム Print_SuGHz.cで使用しています。<br />
	以下のサンプルプログラムは、Print_SubGHz.cのloop関数です。<br />
	decMacの関数でデータを分解した後に、各パラメータを呼び出してシリアル出力しています。<br />
	</p>
<p>
<TEXTAREA wrap="off" name="empty" style="width: 591px; height: 591px" class="auto-style1">void loop(void)
{
	SUBGHZ_MAC_PARAM mac;
	short rx_len;
	short index=0;
	uint16_t data16;
	
	rx_len = SubGHz.readData(rx_data,sizeof(rx_data));
	
	if(rx_len>0)
	{
		SubGHz.getStatus(NULL,&rx);		// get status of rx
		SubGHz.decMac(&mac,rx_data,rx_len);
		Serial.print_long(millis(),DEC);
		Serial.print("\t");

		Serial.print_long(mac.mac_header.header,HEX);
		Serial.print("\t");

		Serial.print_long(mac.seq_num,HEX);
		Serial.print("\t");

		Serial.print_long(mac.rx_panid,HEX);
		Serial.print("\t");

		data16 = *((uint16_t *)mac.rx_addr);
		Serial.print_long(data16,HEX);
		Serial.print("\t");

		data16 = *((uint16_t *)mac.tx_addr);
		Serial.print_long(data16,HEX);
		Serial.print("\t");

		Serial.print_long(rx.rssi,DEC);
		Serial.print("\t");
		
		Serial.print(mac.payload);
		// print ln
		Serial.println("");
		digitalWrite(BLUE_LED, HIGH);
	}
	
	
	return;
}
</TEXTAREA></p>
<p>&nbsp;</p>

</body>

</html>
