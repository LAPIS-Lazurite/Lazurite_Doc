<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>SD Card</title>
<style type="text/css">
#contents{
	width:800px;
	margin-left:auto;
	margin-right:auto;
}
.auto-style1 {
	margin-left: 40px;
}
.auto-style5 {
	text-align: center;
}
.auto-style2 {
	border: 1px solid #000000;
	margin-left: 40px;
}
.auto-style3 {
	border: 1px solid #000000;
}
.auto-style7 {
	color: #666666;
	font-weight: normal;
	font-family: メイリオ;
}
.auto-style8 {
	font-family: メイリオ;
	color: #666666;
}
.auto-style9 {
	margin-left: 40px;
	font-family: メイリオ;
	color: #666666;
}
.auto-style10 {
	border: 1px solid #000000;
	color: #666666;
	font-family: メイリオ;
}
.auto-style11 {
	border: 1px solid #000000;
	text-align: center;
	color: #666666;
	font-family: メイリオ;
}
.auto-style12 {
	font-family: メイリオ;
}
td{
	padding:0px 5px;
}
</style>
</head>

<body>
<h1 class="auto-style5">
<img height="35" src="../Lazurite_logo.png" width="179" class="auto-style1" />　<span class="auto-style7">Lazurite 
日本語リファレンス</span></h1>
<hr />
<div id="contents">
<h1 class="auto-style7">SDカード</h1>
<br/>
<h3 class="auto-style8">概要</h3>
<p class="auto-style9">SDカードライブラリはSPI接続のSDカードを使用するための関数群です。</p>

<p class="auto-style9">SPI接続のSDカードへのアクセスやファイル/フォルダ操作のための<b>SD関数群</b>と、ファイルを読み書きするための<b>File関数群</b>で構成されます。使用できるSDカードは、SDHCまでのFAT16/FAT32フォーマット、最大サイズは32GBです。SDXCカードは非サポートです。</p>

<p class="auto-style9">
本ライブラリを使用するためには、LazuriteIDE上の左ペイン(ライブラリ)から、"SD"と"RTC"、"SPI"のチェックボックスを有効にしてください。<br>※SDカードライブラリはファイル/フォルダの操作でタイムスタンプが必要で、<a href="RTC.html">RTC</a>ライブラリを使用しています。</p>
<p class="auto-style9">
SDカードをSPIで接続するため、MOSI/MISO/SCLK以外にスレーブデバイス識別用のSSピンを使用します。詳しくは<a href="spi.html">SPI</a>を参照してください。</p>


<p class="auto-style1">&nbsp;</p>
<h3 class="auto-style8">関数</h3>
<table class="auto-style2" style="width: 90%">
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p></p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">SD.begin(csPin);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">SDカードの使用を開始するための関数です。SSピン番号csPinを指定します。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p></p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">boolean SD.exists(filepath);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">filepath(フルパス)で指定したファイルまたはフォルダの存在を確認する関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p></p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">SD.mkdir(filepath);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">指定したフォルダを作成する関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">SD.open(filepath, mode, fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">指定したモードmodeでファイルを開く関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p></p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">SD.remove(filepath);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">指定したファイルを削除する関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 18px">
		<p></p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 18px">
		<p class="auto-style12">SD.rmdir(filepath);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 18px">
		<p class="auto-style8">指定したフォルダを削除する関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">+</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.init(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">fileptrの内容を初期化します。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">int File.available(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">ファイルから読み込む残りのバイト数を返す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.close(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">ファイルを閉じる関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.flush(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">キャッシュされた内容をSDカードに書き出す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">int File.peek(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">read()と異なり、読み込み位置を移動せずに1文字読み込む関数です。繰り返すと同じ文字を読み込みます。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">unsigned long File.position(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">次に読み込む、または、書き出す位置を返す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.print(fileptr, buf);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">指定した文字列をファイルに書き出す関数です。<br>※write()に比べてパフォーマンスが落ちます。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.println(fileptr, buf);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">指定した文字列に改行コードを付加して、ファイルに書き出す関数です。<br>※write()に比べてパフォーマンスが落ちます。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.seek(fileptr, pos);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">次に読み込む、または、書き出す位置を指定した位置に移動する関数です。<br>※write()に比べてパフォーマンスが落ちます。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">unsigned long File.size(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">ファイルサイズを返す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.read(fileptr, buf, nbyte);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">ファイルからnbyte分読み込み、bufに格納する関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.write(fileptr, buf, nbyte);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">bufをnbyte分、ファイルに書き出す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">boolean File.isDirectory(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">フォルダかどうかを返す関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.openNextFile(fileptr, ret, mode);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">指定したモードmodeで次のファイル、またはフォルダを開く関数です。</p>
		</td>
	</tr>
	<tr>
		<td class="auto-style11" style="width: 34px; height: 22px;">
		<p class="auto-style8">*</p>
		</td>
		<td class="auto-style3" style="width: 467px; height: 22px;">
		<p class="auto-style12">File.rewindDirectory(fileptr);</p>
		</td>
		<td class="auto-style3" style="width: 673px; height: 22px;">
		<p class="auto-style8">最初のファイルに戻す関数です。openNextFile()と併せて使用します。</p>
		</td>
	</tr>
	</table>
<p class="auto-style8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp; Arduinoと差異がある関数です。<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
+&nbsp;&nbsp;&nbsp; Arduinoになく、Lazuriteにある関数です。&nbsp; </p>
<p class="auto-style1">&nbsp;</p>
<h3 class="auto-style8">サンプル</h3>
<p class="auto-style9">
SDカードライブラリサンプルの共通設定は以下のとおりです。<br>
<ul class="auto-style9">
<li>SSピン：4番</li>
<li>ビットオーダー：MSB First</li>
<li>クロック分周比：SPI_CLOCK_DIV4 (SCLKの周波数 4MHz)</li>
</ul></p>
<p>&nbsp;</p>
<p class="auto-style9">Benchmark</p>
<p class="auto-style9">本サンプルは、1MBのデータをファイルに書き出す時間と読み込む時間をms単位で計測し、シリアルモニタに表示します。
<br>
<br>
※本サンプルはルートフォルダにtest.datというファイルを作成します。実行前にtest.datというファイルがないことを確認してください。</p>
<p>&nbsp;</p>
<p class="auto-style9">CardInfo</p><p class="auto-style9">本サンプルは、カードタイプとFATの種類(FAT16/32)、SDカードサイズをシリアルモニタに表示します。これらの情報はAPIでは取得できず、直接構造体メンバ変数を参照しています。詳しくはライブラリのソースコードを参照してください。</p>
<p>&nbsp;</p>
<p class="auto-style9">DumpFile</p><p class="auto-style9">本サンプルは、4KBのテキストファイルを作成し、その内容を読み込んでシリアルモニタに表示します。
<br>
<br>
※本サンプルはルートフォルダにdatafile.txtというファイルを作成します。実行前にdatafile.txtというファイルがないことを確認してください。</p>
<p>&nbsp;</p>
<p class="auto-style9">Files</p><p class="auto-style9">本サンプルは、ファイルの存在の確認と作成、および消去を実行します。
<br>
<br>
※本サンプルはルートフォルダにexample.txtというファイルを作成します。実行前にexample.txtというファイルがないことを確認してください。</p>
<p>&nbsp;</p>
<p class="auto-style9">ListFiles</p><p class="auto-style9">本サンプルは、SDカード上のファイルの名前とサイズを取得し、シリアルモニタに一覧表示します。</p>
<p>&nbsp;</p>
<p class="auto-style9">MkRmvDir</p><p class="auto-style9">本サンプルは、フォルダを作成し、作成したフォルダ内にファイルを作成します。また、作成したフォルダ内のファイルを消去し、作成したフォルダを消去します。
<br>
<br>
※本サンプルはルートフォルダにtestというフォルダを作成します。実行前にtestというフォルダがないことを確認してください。</p>
<p>&nbsp;</p>
<p class="auto-style9">ReadWrite</p><p class="auto-style9">本サンプルは、ファイルを追記モードで開いて、16バイトのテキストデータを追加書き込みし、内容を読み込んでシリアルモニタに表示します。
<br>
<br>
※本サンプルはルートフォルダにtest.txtというファイルを作成します。実行前にtest.txtというファイルがないことを確認してください。</p>
</div>
</body>

</html>
